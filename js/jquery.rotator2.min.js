Array.prototype.rotate=function(){var c=Array.prototype.push,f=Array.prototype.splice;return function(i){var a=this.length>>>0;c.apply(this,f.call(this,0,((i>>0)%a+a)%a));return this}}();allowBreakpoints=!1;
(function(c){c.rotator2=function(f,i){var a=this,b;a.$el=c(f);a.$el.data("rotator_link",a);a.currentPage=1;a.timer=null;a.animating=!1;a.playing=!1;a.items=[];a.init=function(){a.options=b=c.extend({},c.rotator2.defaults,i);if(b.blocksChangePerPage>b.blocksPerScreen)b.blocksChangePerPage=b.blocksPerScreen;a.$items=a.$el.find(b.itemsSelector);a.items=a.$items.toArray();a.items_count=a.$items.length;a.containerName="RotatorContainer";a.containerSelector="."+a.containerName;a.after_animate_css={"margin-left":"-100%",
left:0};var d=[];b.prev&&d.push(b.prev);b.next&&d.push(b.next);b.buttons_selector=d.join(", ");if(b.blocksPerScreen>b.items_count)b.blocksPerScreen=a.items_count;if(!c.isFunction(c.easing[b.easing]))b.easing="swing";a.page_count=Math.ceil(a.items_count/b.blocksChangePerPage);a.block_count=Math.ceil(a.items_count/b.blocksPerScreen)+1;a.container_width=400;a.items_width=100/(4*b.blocksPerScreen);a.$items.each(function(a){c(this).data("index",a+1).attr("index",a+1)}).css("width",a.items_width+"%").wrapAll('<div style="width: '+
a.container_width+'%;" class="'+a.containerName+'"/>');a.$container=a.$el.find(a.containerSelector);a.$el.css("overflow","hidden");3<a.page_count&&(a.rotateItems(b.startPage),a.refreshSlider(),a.$container.css({"margin-left":4*-a.items_width*b.blocksPerScreen+"%"}));if(a.items_count<=b.blocksPerScreen)a.$el.addClass("not-enough-slides-static"),c(b.buttons_selector).hide(),c(b.navSelector).hide();else{a.buildNextPrevButtons();b.navSelector&&1<a.page_count&&a.buildNavigation();b.useSwipeTouch&&a.addSwipeTouchListener();
b.keyboardNavigation&&a.addKeyboardListener();if(b.autoPlay)a.playing=!0,a.startStop();b.pauseOnHover&&a.addOnHoverListener();b.hashPrefix&&(a.addHashChangeListener(),c(window).trigger("hashchange"))}b.autoWidthCheck&&(d=!!c.browser.opera,"opera"==b.autoWidthCheck?d&&a.checkResize():a.checkResize())};a.addHashChangeListener=function(){c(window).bind("hashchange",function(d){d=d.getState(b.hashPrefix,!0)||1;a.animating||a.gotoPage(d)})};a.addSwipeTouchListener=function(){c(this).bind({swipeleft:function(){a.animating||
a.goNextPage()},swiperight:function(){a.animating||a.goPrevPage()}})};a.addKeyboardListener=function(){c(document).keydown(function(b){if(a.animating)return!1;37==b.which?a.goPrevPage():39==b.which&&a.goNextPage()})};a.addOnHoverListener=function(){var d=[];d.push(a);b.prev&&d.push(b.prev);b.next&&d.push(b.next);b.navSelector&&d.push(b.navSelector);c(d.join(", ")).hover(function(){a.clearTimer()},function(){a.startStop()})};a.buildNavigation=function(){for(var d=a.page_count,e,j,g=c(b.navSelector),
h=0;h<d;h++){e=[];j=b.blocksChangePerPage;for(var f=h*j+1;f<(h+1)*j+1;f++)e.push(f);e=c(b.navPageTemplate.replace("$i",h+1)).data("page",h).data("items",e).attr("title","\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u043d\u0430 \u0441\u043b\u0430\u0439\u0434 "+(h+1));b.hashPrefix&&e.attr("href","#"+b.hashPrefix+"="+(h+1));b.navDrawPageNumber&&e.text(h+1);g.append(e)}g.find("a").first().addClass("Active");g.delegate("a","click",function(){if(a.animating||
c(this).hasClass("Active"))return!1;var d=c(this).data("items")[0],e=(d-1)/b.blocksChangePerPage+1;g.removeClass("Active");c(this).addClass("Active");b.hashPrefix&&a.updateHashUrl(d);a.gotoPage(e);return!1})};a.buildNextPrevButtons=function(){b.hashPrefix&&a.updateNextPrevLinks();a.$el.parent().find(b.buttons_selector).click(function(){a.animating||(c(this).is(b.prev)?a.goPrevPage():a.goNextPage());return!1})};a.startStop=function(){if(!0!==a.playing)a.playing=!1;a.playing?(a.clearTimer(),a.timer=
setTimeout(function(){a.animating||a.goNextPage()},b.delay+b.duration)):a.clearTimer()};a.clearTimer=function(){if(a.timer)clearTimeout(a.timer),a.timer=null};a.updateHashUrl=function(a){var e={};e[b.hashPrefix]=a;c.bbq.pushState(e)};a.updateNextPrevLinks=function(){var d=1<a.currentPage?a.currentPage-1:a.page_count,e=a.currentPage<a.page_count?a.currentPage+1:1;c(b.prev).attr("href","#"+b.hashPrefix+"="+d);c(b.next).attr("href","#"+b.hashPrefix+"="+e)};a.loadSlideAndSiblings=function(b){0<b.length&&
(a.loadSlide(b),a.loadSlide(b.next()),a.loadSlide(b.prev()))};a.loadSlide=function(a){if(a){var b=a.attr("loadsrc");b&&c("<img />").attr("src",b).load(function(){a.attr("src",b)})}};a.changeToSlide=function(d){var d=a.$items.eq(d-1).attr("loadsrc"),e=c(".ContentRotatorLoader").show();a.$container.children(b.itemsSelector).first().attr("src",d);e.hide();b.hashPrefix&&a.updateNextPrevLinks();a.animating=!1;if(b.onMoveComplete&&"function"==typeof b.onMoveComplete)b.onMoveComplete(a.currentPage)};a.gotoPage=
function(d){if(!(a.animating||a.currentPage==d)){a.animating=!0;a.clearTimer();var e,c,g=a.$container,h=a.currentPage;"prev"==d||"next"==d?(c=b.blocksChangePerPage,e="prev"==d,d=parseInt(e?1<h?h-1:a.page_count:h<a.page_count?h+1:1,10)):(c=Math.abs(h-d)*b.blocksChangePerPage,c=c>a.items_count/2?a.items_count-c:c,e=((h-1)*b.blocksChangePerPage+1+c)%a.items_count,e=0==e?a.items_count:e,e=e!=(d-1)*b.blocksChangePerPage+1,c==a.items_count/2&&(e=!1),d=parseInt(d,10));a.nextPage=d;if(e&&c>b.blocksPerScreen){g.find(b.itemsSelector).slice(-b.blocksPerScreen).remove();
a.rotateItems((d-1)*b.blocksChangePerPage+1);d=a.items.slice(b.blocksPerScreen,2*b.blocksPerScreen);if(d.length==b.blocksPerScreen&&(g.prepend(d),d=3*b.blocksPerScreen-g.find(b.itemsSelector).length,0<d&&g.prepend(a.items.slice(b.blocksPerScreen-d,2*b.blocksPerScreen-d)),allowBreakpoints))debugger;g.css("margin-left","-200%")}else if(!e&&c>2*b.blocksPerScreen-1){if(a.rotateItems((d-1)*b.blocksChangePerPage+1),g.find(b.itemsSelector).slice(0,b.blocksPerScreen).remove(),g.append(a.items.slice(b.blocksPerScreen,
2*b.blocksPerScreen)),g.css("margin-left","0%"),allowBreakpoints)debugger}else if(!e&&c>b.blocksPerScreen&&c<=2*b.blocksPerScreen)a.rotateItems((d-1)*b.blocksChangePerPage+1),d=Math.abs(c)%b.blocksPerScreen,f=-100+(e?-100:100)*(d/b.blocksPerScreen),g.find(b.itemsSelector).slice(0,d).remove(),g.append(a.items.slice(b.blocksPerScreen,2*b.blocksPerScreen)),g.css("margin-left",f+"%");else{var f;a.rotateItems((d-1)*b.blocksChangePerPage+1);f=-100+(e?-100:100)*(c/b.blocksPerScreen);a.refreshSlider();g.css("margin-left",
f+"%");if(allowBreakpoints)debugger}if(b.onBeforeAnimation&&"function"==typeof b.onBeforeAnimation)b.onBeforeAnimation(a.nextPage);a.animateRotator(h,c,e);a.startStop()}};a.animateRotator=function(d,c,f){d=100*Math.min(c,2*b.blocksPerScreen)/b.blocksPerScreen;a.$container.animate({left:(f?"+":"-")+"="+d+"%"},{duration:b.duration,easing:b.easing,complete:function(){a.onAnimationComplete()}})};a.onAnimationComplete=function(){var d=a.$container,e=c(b.navSelector).find("a");a.refreshSlider();d.css(a.after_animate_css);
a.rotateItems(a.nextPage*b.blocksChangePerPage);a.currentPage=a.nextPage;b.navSelector&&e.removeClass("Active").eq(a.currentPage-1).addClass("Active");b.hashPrefix&&a.updateNextPrevLinks();a.animating=!1;if(b.onMoveComplete&&"function"==typeof b.onMoveComplete)b.onMoveComplete(a.currentPage)};a.refreshSlider=function(){a.$container.find(b.itemsSelector).remove();a.$container.append(a.items.slice(0,3*b.blocksPerScreen))};a.goNextPage=function(){b.hashPrefix&&a.updateHashUrl(a.currentPage<a.page_count?
a.currentPage+1:1);a.gotoPage("next")};a.goPrevPage=function(){b.hashPrefix&&a.updateHashUrl(1<a.currentPage?a.currentPage-1:a.page_count);a.gotoPage("prev")};a.centerOnCurrentSlide=function(){var b=a.currentPage,c=b+3,c=c>a.items_count-1||1>c?Math.abs(a.items_count-Math.abs(c)):c;if(b<c-1||b>c+1)b=3<b?b-3:a.items_count-Math.abs(b-3),a.gotoPage(b)};a.rotateItems=function(d){d&&(d-=c(a.items.slice(b.blocksPerScreen,b.blocksPerScreen+1)).attr("index"),a.items.rotate(d))};a.checkResize=function(d){clearTimeout(a.resizeTimer);
a.resizeTimer=setTimeout(function(){var c=4*a.$container.find(b.itemsSelector).first().width()*b.blocksPerScreen,f=a.$container.outerWidth();(c>f+10||c<f-10)&&a.$items.css("width",f/(4*b.blocksPerScreen));"undefined"===typeof d&&a.checkResize()},750)};a.init()};c.rotator2.defaults={itemsSelector:".RotatorItem",prev:".RotatorPrevLink",next:".RotatorNextLink",blocksPerScreen:1,blocksChangePerPage:1,duration:1E3,easing:"swing",navSelector:null,navDrawPageNumber:!1,navPageTemplate:'<a href="#$n"><span>$i</span></a>',
keyboardNavigation:!1,onBeforeAnimation:!1,onMoveComplete:!1,autoPlay:!1,delay:6E3,pauseOnHover:!1,useSwipeTouch:!1,hashPrefix:!1,lazyLoad:!1,startPage:1,autoWidthCheck:"opera"};c.fn.rotator2=function(f){if((typeof f).match("object|undefined"))return this.each(function(){new c.rotator2(this,f)});if(/\d/.test(f)&&!isNaN(f))return this.each(function(){var i=c.data(this,"rotator_link");if(i){var a="number"==typeof f?f:parseInt(c.trim(f),10);1>a||a>i.items_count||i.gotoPage(a)}})}})(jQuery);
